/**
 * Ð£Ñ‚Ð¸Ð»Ð¸Ñ‚Ñ‹ Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ñ‡Ð°ÑÐ¾Ð²Ñ‹Ð¼Ð¸ Ð¿Ð¾ÑÑÐ°Ð¼Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
 */

/**
 * ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ‡Ð°ÑÐ¾Ð²Ð¾Ð³Ð¾ Ð¿Ð¾ÑÑÐ° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, "Europe/Moscow")
 */
export const getUserTimezone = (): string => {
  try {
    return Intl.DateTimeFormat().resolvedOptions().timeZone;
  } catch (error) {
    console.warn('ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÑŒ timezone:', error);
    return 'Europe/Moscow';
  }
};

/**
 * ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ ÑÐ¼ÐµÑ‰ÐµÐ½Ð¸Ðµ Ñ‡Ð°ÑÐ¾Ð²Ð¾Ð³Ð¾ Ð¿Ð¾ÑÑÐ° Ð² Ð¼Ð¸Ð½ÑƒÑ‚Ð°Ñ… (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, -180 Ð´Ð»Ñ GMT+3)
 * ÐžÑ‚Ñ€Ð¸Ñ†Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¾Ð·Ð½Ð°Ñ‡Ð°ÐµÑ‚ Ð²Ð¾ÑÑ‚Ð¾Ñ‡Ð½ÐµÐµ UTC
 */
export const getTimezoneOffset = (): number => {
  try {
    return new Date().getTimezoneOffset();
  } catch (error) {
    console.warn('ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÑŒ timezone offset:', error);
    return -180;
  }
};

/**
 * ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð»Ð½ÑƒÑŽ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾ Ñ‡Ð°ÑÐ¾Ð²Ð¾Ð¼ Ð¿Ð¾ÑÑÐµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
 */
export const getTimezoneInfo = () => {
  return {
    timezone: getUserTimezone(),
    timezoneOffset: getTimezoneOffset(),
    currentTime: new Date().toISOString(),
  };
};

/**
 * ÐšÐ¾Ð½Ð²ÐµÑ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ offset Ð² Ñ‡Ð¸Ñ‚Ð°ÐµÐ¼Ñ‹Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, "+03:00")
 */
export const formatTimezoneOffset = (offset: number): string => {
  const hours = Math.floor(Math.abs(offset) / 60);
  const minutes = Math.abs(offset) % 60;
  const sign = offset <= 0 ? '+' : '-'; // Ð˜Ð½Ð²ÐµÑ€Ñ‚Ð¸Ñ€ÑƒÐµÐ¼ Ð·Ð½Ð°Ðº (getTimezoneOffset Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ð¾Ð±Ñ€Ð°Ñ‚Ð½Ð¾Ðµ)
  
  return `${sign}${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
};

/**
 * Ð›Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¾ timezone Ð´Ð»Ñ Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ¸
 */
export const logTimezoneInfo = () => {
  const info = getTimezoneInfo();
  console.log('ðŸ•’ Timezone Info:', {
    timezone: info.timezone,
    offset: info.timezoneOffset,
    formatted: formatTimezoneOffset(info.timezoneOffset),
    currentTime: info.currentTime,
    localTime: new Date().toLocaleString(),
  });
  return info;
}; 